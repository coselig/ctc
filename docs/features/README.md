# 功能模組文檔

本目錄包含應用程式各個功能模組的設計、實作和使用文檔。

## 📁 文檔列表

### 🔐 權限管理系統

- **[permission_system_summary.md](permission_system_summary.md)**
  - 權限管理系統的全面總結
  - 系統架構和核心概念
  - 安全性考量和最佳實務

- **[permission_system_user_guide.md](permission_system_user_guide.md)**
  - 使用者操作指南
  - 管理員功能說明
  - 常見問題和解決方案

## 🏗️ 系統架構

### 權限層級

1. **Level 1 (基礎使用者)**
   - 查看設計圖
   - 新增照片記錄
   - 查看自己的記錄

2. **Level 2 (進階使用者)**
   - Level 1 的所有權限
   - 編輯照片記錄
   - 查看其他人的記錄

3. **Level 3 (管理員)**
   - Level 2 的所有權限
   - 刪除任何記錄
   - 管理使用者權限
   - 轉移擁有權

### 核心元件

- **Models**: `PermissionLevel`, `FloorPlanPermission`
- **Services**: `PermissionService`, `SupabaseService`
- **UI**: `PermissionManagementPage`, 權限控制元件

## 🚀 快速開始

### 管理員設定

1. 登入具有管理員權限的帳號
2. 進入設計圖管理頁面
3. 點擊「權限管理」按鈕
4. 新增或編輯使用者權限

### 使用者操作

1. 登入應用程式
2. 選擇有權限的設計圖
3. 根據權限等級進行操作：
   - 查看/新增/編輯/刪除 照片記錄
   - 管理其他使用者（管理員）

## 🔒 安全機制

### 資料庫層級

- **RLS (Row Level Security)**: 資料表層級的安全控制
- **擁有權檢查**: 專用函數避免遞迴查詢
- **權限驗證**: 每個操作都經過權限檢查

### 應用程式層級

- **前端驗證**: UI 根據權限動態調整
- **服務層檢查**: 所有 API 調用都經過權限驗證
- **錯誤處理**: 優雅處理權限不足的情況

## 📋 操作流程

### 新增使用者權限

1. 確認擁有管理員權限
2. 開啟權限管理頁面
3. 輸入使用者 Email 和權限等級
4. 確認新增並同步資料庫

### 轉移擁有權

1. 只有擁有者可以轉移擁有權
2. 選擇新的擁有者
3. 系統自動更新所有相關記錄
4. 原擁有者權限調整為管理員

## 🛠️ 維護注意事項

- 定期檢查權限設定的正確性
- 監控異常的權限使用行為
- 備份權限設定資料
- 測試新功能對權限系統的影響

## 📞 支援與問題回報

如遇到權限相關問題，請檢查：

1. 使用者是否已正確登入
2. 權限等級是否足夠
3. 設計圖擁有權是否正確
4. 資料庫 RLS 策略是否正常運作
